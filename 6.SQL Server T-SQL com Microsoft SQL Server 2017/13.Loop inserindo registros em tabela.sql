-- Loop para inserir registros em uma tabela

USE [SUCOS_VENDAS]

-- Se a tabela [TABELA DE NUMEROS] existir no banco, ela será excluida
IF OBJECT_ID ('TABELA DE NUMEROS','U') IS NOT NULL
   DROP TABLE [TABELA DE NUMEROS]

-- Criação da tabela auxiliar
CREATE TABLE [TABELA DE NUMEROS] ([NUMERO] INT, [STATUS] VARCHAR(200))

--Declaração de variáveis
DECLARE @LIMITE_MINIMO INT, @LIMITE_MAXIMO INT, @CONTADOR_NOTAS INT

SET @LIMITE_MINIMO = 1
SET @LIMITE_MAXIMO = 100000

-- Percorre cada Nota Fiscal e preenche o número e o status
SET NOCOUNT ON
WHILE @LIMITE_MINIMO <= @LIMITE_MAXIMO
	BEGIN
	   SELECT @CONTADOR_NOTAS = COUNT(*) FROM [NOTAS FISCAIS] WHERE [NUMERO] = @LIMITE_MINIMO
	   IF @CONTADOR_NOTAS > 0 
		   INSERT INTO [TABELA DE NUMEROS] ([NUMERO], [STATUS]) VALUES (@LIMITE_MINIMO, 'É nota fiscal')
	   ELSE
		   INSERT INTO [TABELA DE NUMEROS] ([NUMERO], [STATUS]) VALUES (@LIMITE_MINIMO, 'Não é nota fiscal')
	   SET @LIMITE_MINIMO = @LIMITE_MINIMO + 1   
	END

SELECT * FROM [TABELA DE NUMEROS]